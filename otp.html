<!DOCTYPE html>
<html>
<head>
<title>OTP Verification</title>

<style>
body{
    margin:0;
    font-family:'Segoe UI',sans-serif;
    height:100vh;
    background:linear-gradient(135deg,#1aad19,#7ed957);
    display:flex;
    justify-content:center;
    align-items:center;
}
.card{
    background:white;
    padding:30px;
    border-radius:15px;
    width:360px;
    text-align:center;
    box-shadow:0 15px 30px rgba(0,0,0,0.3);
}
.otp-boxes{
    display:flex;
    justify-content:space-between;
    margin:20px 0;
}
.otp-boxes input{
    width:60px;
    height:60px;
    font-size:24px;
    text-align:center;
    border-radius:8px;
    border:1px solid #ccc;
}
button{
    width:100%;
    padding:14px;
    background:#1aad19;
    border:none;
    color:white;
    font-size:16px;
    border-radius:8px;
    cursor:pointer;
}
.resend{
    margin-top:15px;
    font-size:14px;
}
.resend a{
    color:#1aad19;
    font-weight:bold;
    text-decoration:none;
    cursor:pointer;
}
#error{
    color:red;
    margin-top:10px;
    font-size:14px;
}
</style>
</head>

<body>

<div class="card">
    <h2>OTP Verification</h2>
    <p>Enter the 4-digit OTP</p>

    <div class="otp-boxes">
        <input maxlength="1" onkeyup="moveNext(this,event)">
        <input maxlength="1" onkeyup="moveNext(this,event)">
        <input maxlength="1" onkeyup="moveNext(this,event)">
        <input maxlength="1" onkeyup="moveNext(this,event)">
    </div>

    <button onclick="verifyOTP()">Verify OTP</button>

    <div class="resend">
        <span id="timer">Resend in 30s</span>
        <a id="resendLink" onclick="resendOTP()" style="display:none;">Resend OTP</a>
    </div>

    <div id="error"></div>
</div>

<script>
let generatedOTP = localStorage.getItem("generatedOTP");
let timeLeft = 30;
let timer;

// START TIMER
function startTimer(){
    document.getElementById("resendLink").style.display = "none";
    document.getElementById("timer").style.display = "inline";
    timeLeft = 30;
    document.getElementById("timer").innerText = "Resend in " + timeLeft + "s";

    timer = setInterval(()=>{
        timeLeft--;
        document.getElementById("timer").innerText = "Resend in " + timeLeft + "s";

        if(timeLeft <= 0){
            clearInterval(timer);
            document.getElementById("timer").style.display = "none";
            document.getElementById("resendLink").style.display = "inline";
        }
    },1000);
}

// RESEND OTP
function resendOTP(){
    generatedOTP = Math.floor(1000 + Math.random() * 9000).toString();
    localStorage.setItem("generatedOTP", generatedOTP);

    alert("Your new OTP is: " + generatedOTP);

    document.querySelectorAll(".otp-boxes input").forEach(i => i.value = "");
    document.getElementById("error").innerText = "";

    startTimer();
}

// VERIFY OTP
function verifyOTP(){
    let entered = "";
    document.querySelectorAll(".otp-boxes input").forEach(i=>{
        entered += i.value;
    });

    if(entered.length < 4){
        document.getElementById("error").innerText = "Please enter complete OTP";
        return;
    }

    if(entered === generatedOTP){
        localStorage.removeItem("generatedOTP");
        window.location.href = "home.html";
    }else{
        document.getElementById("error").innerText = "Invalid OTP";
    }
}

// AUTO MOVE CURSOR
function moveNext(current,event){
    if(current.value.length === 1 && event.key !== "Backspace"){
        let next = current.nextElementSibling;
        if(next) next.focus();
    }
    if(event.key === "Backspace" && current.value === ""){
        let prev = current.previousElementSibling;
        if(prev) prev.focus();
    }
}

// INIT
startTimer();
</script>

</body>
</html>
