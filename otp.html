<!DOCTYPE html>
<html>
<head>
<title>Farm To Home - OTP Verification</title>

<style>
body{
    margin:0;
    font-family:'Segoe UI',sans-serif;
    height:100vh;
    background:linear-gradient(135deg,#1aad19,#7ed957);
    display:flex;
    align-items:center;
    justify-content:center;
}
.otp-card{
    width:360px;
    background:white;
    border-radius:18px;
    padding:32px;
    box-shadow:0 18px 35px rgba(0,0,0,0.3);
    text-align:center;
}
.logo{
    font-size:26px;
    font-weight:bold;
    color:#1aad19;
}
.info{
    font-size:14px;
    color:#666;
    margin-bottom:22px;
}
.otp-boxes{
    display:flex;
    justify-content:space-between;
    margin:20px 0;
}
.otp-boxes input{
    width:60px;
    height:60px;
    font-size:24px;
    text-align:center;
    border-radius:10px;
    border:1px solid #ccc;
}
button{
    width:100%;
    padding:14px;
    background:#1aad19;
    border:none;
    color:white;
    font-size:16px;
    border-radius:10px;
}
.resend{
    margin-top:16px;
    font-size:14px;
}
.resend a{
    color:#1aad19;
    font-weight:bold;
}
</style>
</head>

<body>

<div class="otp-card">
    <div class="logo">Farm To Home ðŸŒ±</div>
    <div class="info">Enter the 4-digit OTP sent to your mobile number</div>

    <div class="otp-boxes">
        <input maxlength="1" onkeyup="moveNext(this,event)">
        <input maxlength="1" onkeyup="moveNext(this,event)">
        <input maxlength="1" onkeyup="moveNext(this,event)">
        <input maxlength="1" onkeyup="moveNext(this,event)">
    </div>

    <button onclick="verifyOTP()">Verify OTP</button>

    <p id="error" style="color:red;"></p>

    <div class="resend">
        Didnâ€™t receive OTP?
        <span id="timer">Resend in 30s</span>
        <a href="#" id="resendLink" style="display:none;" onclick="resendOTP(event)">Resend</a>
    </div>

    <p id="message" style="color:green;"></p>
</div>

<script>
// ---------- OTP STORAGE (FIX) ----------
let generatedOTP = localStorage.getItem("generatedOTP");

if(!generatedOTP){
    generatedOTP = Math.floor(1000 + Math.random() * 9000).toString();
    localStorage.setItem("generatedOTP", generatedOTP);

    setTimeout(()=>{
        alert("Your OTP is: " + generatedOTP);
    },500);
}

// ---------- TIMER ----------
let timeLeft = 30;
let timer;

function startTimer(){
    document.getElementById("resendLink").style.display="none";
    document.getElementById("timer").style.display="inline";
    timeLeft=30;
    document.getElementById("timer").innerText="Resend in "+timeLeft+"s";

    timer=setInterval(()=>{
        timeLeft--;
        document.getElementById("timer").innerText="Resend in "+timeLeft+"s";
        if(timeLeft<=0){
            clearInterval(timer);
            document.getElementById("timer").style.display="none";
            document.getElementById("resendLink").style.display="inline";
        }
    },1000);
}

// ---------- RESEND OTP ----------
function resendOTP(e){
    e.preventDefault();
    generatedOTP=Math.floor(1000 + Math.random() * 9000).toString();
    localStorage.setItem("generatedOTP", generatedOTP);
    alert("Your new OTP is: " + generatedOTP);
    document.querySelectorAll(".otp-boxes input").forEach(i=>i.value="");
    document.getElementById("message").innerText="OTP resent successfully âœ”";
    startTimer();
}

// ---------- VERIFY ----------
function verifyOTP(){
    let entered="";
    document.querySelectorAll(".otp-boxes input").forEach(i=>entered+=i.value);

    if(entered.length<4){
        document.getElementById("error").innerText="Enter complete OTP";
        return;
    }

    if(entered===generatedOTP){
        localStorage.removeItem("generatedOTP");
        window.location.href="home.html";
    }else{
        document.getElementById("error").innerText="Invalid OTP";
    }
}

// ---------- AUTO MOVE ----------
function moveNext(current,event){
    if(current.value && current.nextElementSibling){
        current.nextElementSibling.focus();
    }
    if(event.key==="Backspace" && current.previousElementSibling){
        current.previousElementSibling.focus();
    }
}

startTimer();
</script>

</body>
</html>
